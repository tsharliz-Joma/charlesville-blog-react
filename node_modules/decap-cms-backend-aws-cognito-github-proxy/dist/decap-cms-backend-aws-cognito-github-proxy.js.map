{"version":3,"file":"decap-cms-backend-aws-cognito-github-proxy.js","mappings":"CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,EAAQG,QAAQ,4BAA6BA,QAAQ,SAAUA,QAAQ,qBAAsBA,QAAQ,mBAC7F,mBAAXC,QAAyBA,OAAOC,IAC9CD,OAAO,uCAAwC,CAAC,2BAA4B,QAAS,oBAAqB,kBAAmBJ,GACnG,iBAAZC,QACdA,QAA8C,qCAAID,EAAQG,QAAQ,4BAA6BA,QAAQ,SAAUA,QAAQ,qBAAsBA,QAAQ,mBAEvJJ,EAA2C,qCAAIC,EAAQD,EAA4B,sBAAGA,EAAY,MAAGA,EAAqB,eAAGA,EAA6B,uBAAe,YAC1K,CATD,CASGO,OAAQ,CAACC,EAAkCC,EAAkCC,EAAkCC,I,iCCTlHR,EAAOD,QAAUS,C,SCAjBR,EAAOD,QAAUO,C,SCAjBN,EAAOD,QAAUM,C,SCAjBL,EAAOD,QAAUQ,C,GCCbE,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAab,QAGrB,IAAIC,EAASS,EAAyBE,GAAY,CAGjDZ,QAAS,CAAC,GAOX,OAHAe,EAAoBH,GAAUX,EAAQA,EAAOD,QAASW,GAG/CV,EAAOD,OACf,CCrBAW,EAAoBK,EAAI,CAAChB,EAASiB,KACjC,IAAI,IAAIC,KAAOD,EACXN,EAAoBQ,EAAEF,EAAYC,KAASP,EAAoBQ,EAAEnB,EAASkB,IAC5EE,OAAOC,eAAerB,EAASkB,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,MCJ3EP,EAAoBQ,EAAI,CAACK,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,G,qGCQnE,MAAMI,UAAqCC,EAAAA,cACxDC,WAAAA,CAAYC,EAAgBC,EAAU,CAAC,GACrCC,MAAMF,EAAQC,GAEdE,KAAKC,oCAAqC,EAC1CD,KAAKE,aAAe,QACtB,CAEAC,aAAAA,GACE,MAAMC,EAA6BC,IACjC,MAAMC,EAAW,IAAKD,EAAOE,QAASP,MACtC,OAAOQ,EAAAA,EAAAA,KAACC,EAAAA,uBAA2BH,IAGrC,OADAF,EAA0BM,YAAc,qBACjCN,CACT,CAEA,iBAAMO,EAAY,MAAEC,IAoBlB,OAnBKZ,KAAKa,sBACRb,KAAKa,oBAAsBC,MAAMd,KAAKe,QAAU,mBAAoB,CAClEC,QAAS,CACPC,cAAe,GAAGjB,KAAKE,gBAAgBU,OAExCM,KAAKC,UACN,GAAkB,KAAdC,EAAIC,OAEN,OADArB,KAAKsB,SACEC,QAAQC,OAAO,iBAExB,MAAMC,QAAiBL,EAAIM,OACrBC,EAAQ3B,KAAK4B,WAAWC,MAAM,KAAK,GACzC,MAAO,CACLC,KAAML,EAASM,MACfC,MAAOL,EACPM,WAAY,sBAAsBN,YAIjC3B,KAAKa,mBACd,CAEA,0BAAMqB,CACJC,GAEA,OAAOA,EAAYC,MAAMJ,KAC3B,EChDK,MAAMK,EAAuC,CAClD3C,6BAA4B,EAC5B4C,IAAGA,EAAAA,K","sources":["webpack://DecapCmsBackendAwsCognitoGithubProxy/webpack/universalModuleDefinition","webpack://DecapCmsBackendAwsCognitoGithubProxy/external umd {\"root\":[\"DecapCmsDefaultExports\",\"EmotionCore\"],\"commonjs2\":\"@emotion/react\",\"commonjs\":\"@emotion/react\",\"amd\":\"@emotion/react\",\"umd\":\"@emotion/react\"}","webpack://DecapCmsBackendAwsCognitoGithubProxy/external umd {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\",\"umd\":\"react\"}","webpack://DecapCmsBackendAwsCognitoGithubProxy/external umd {\"root\":[\"DecapCmsBackendGithub\"],\"commonjs2\":\"decap-cms-backend-github\",\"commonjs\":\"decap-cms-backend-github\",\"amd\":\"decap-cms-backend-github\",\"umd\":\"decap-cms-backend-github\"}","webpack://DecapCmsBackendAwsCognitoGithubProxy/external umd {\"root\":[\"DecapCmsUiAuth\"],\"commonjs2\":\"decap-cms-ui-auth\",\"commonjs\":\"decap-cms-ui-auth\",\"amd\":\"decap-cms-ui-auth\",\"umd\":\"decap-cms-ui-auth\"}","webpack://DecapCmsBackendAwsCognitoGithubProxy/webpack/bootstrap","webpack://DecapCmsBackendAwsCognitoGithubProxy/webpack/runtime/define property getters","webpack://DecapCmsBackendAwsCognitoGithubProxy/webpack/runtime/hasOwnProperty shorthand","webpack://DecapCmsBackendAwsCognitoGithubProxy/./src/implementation.tsx","webpack://DecapCmsBackendAwsCognitoGithubProxy/./src/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"decap-cms-backend-github\"), require(\"react\"), require(\"decap-cms-ui-auth\"), require(\"@emotion/react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"DecapCmsBackendAwsCognitoGithubProxy\", [\"decap-cms-backend-github\", \"react\", \"decap-cms-ui-auth\", \"@emotion/react\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"DecapCmsBackendAwsCognitoGithubProxy\"] = factory(require(\"decap-cms-backend-github\"), require(\"react\"), require(\"decap-cms-ui-auth\"), require(\"@emotion/react\"));\n\telse\n\t\troot[\"DecapCmsBackendAwsCognitoGithubProxy\"] = factory(root[\"DecapCmsBackendGithub\"], root[\"React\"], root[\"DecapCmsUiAuth\"], root[\"DecapCmsDefaultExports\"][\"EmotionCore\"]);\n})(window, (__WEBPACK_EXTERNAL_MODULE__403__, __WEBPACK_EXTERNAL_MODULE__119__, __WEBPACK_EXTERNAL_MODULE__484__, __WEBPACK_EXTERNAL_MODULE__110__) => {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__110__;","module.exports = __WEBPACK_EXTERNAL_MODULE__119__;","module.exports = __WEBPACK_EXTERNAL_MODULE__403__;","module.exports = __WEBPACK_EXTERNAL_MODULE__484__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import * as React from 'react';\nimport { GitHubBackend } from 'decap-cms-backend-github';\nimport { PKCEAuthenticationPage } from 'decap-cms-ui-auth';\n\nimport type { GitHubUser } from 'decap-cms-backend-github/src/implementation';\nimport type { Config } from 'decap-cms-lib-util/src';\nimport type { Endpoints } from '@octokit/types';\n\nexport default class AwsCognitoGitHubProxyBackend extends GitHubBackend {\n  constructor(config: Config, options = {}) {\n    super(config, options);\n\n    this.bypassWriteAccessCheckForAppTokens = true;\n    this.tokenKeyword = 'Bearer';\n  }\n\n  authComponent() {\n    const wrappedAuthenticationPage = (props: Record<string, unknown>) => {\n      const allProps = { ...props, backend: this };\n      return <PKCEAuthenticationPage {...allProps} />;\n    };\n    wrappedAuthenticationPage.displayName = 'AuthenticationPage';\n    return wrappedAuthenticationPage;\n  }\n\n  async currentUser({ token }: { token: string }): Promise<GitHubUser> {\n    if (!this._currentUserPromise) {\n      this._currentUserPromise = fetch(this.baseUrl + '/oauth2/userInfo', {\n        headers: {\n          Authorization: `${this.tokenKeyword} ${token}`,\n        },\n      }).then(async (res: Response): Promise<GitHubUser> => {\n        if (res.status == 401) {\n          this.logout();\n          return Promise.reject('Token expired');\n        }\n        const userInfo = await res.json();\n        const owner = this.originRepo.split('/')[1];\n        return {\n          name: userInfo.email,\n          login: owner,\n          avatar_url: `https://github.com/${owner}.png`,\n        } as GitHubUser;\n      });\n    }\n    return this._currentUserPromise;\n  }\n\n  async getPullRequestAuthor(\n    pullRequest: Endpoints['GET /repos/{owner}/{repo}/pulls']['response']['data'][0],\n  ) {\n    return pullRequest.user?.login;\n  }\n}\n","import { API } from 'decap-cms-backend-github';\n\nimport AwsCognitoGitHubProxyBackend from './implementation';\n\nexport const DecapCmsBackendAwsCognitoGithubProxy = {\n  AwsCognitoGitHubProxyBackend,\n  API,\n};\n\nexport { AwsCognitoGitHubProxyBackend, API };\n"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__403__","__WEBPACK_EXTERNAL_MODULE__119__","__WEBPACK_EXTERNAL_MODULE__484__","__WEBPACK_EXTERNAL_MODULE__110__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","AwsCognitoGitHubProxyBackend","GitHubBackend","constructor","config","options","super","this","bypassWriteAccessCheckForAppTokens","tokenKeyword","authComponent","wrappedAuthenticationPage","props","allProps","backend","___EmotionJSX","PKCEAuthenticationPage","displayName","currentUser","token","_currentUserPromise","fetch","baseUrl","headers","Authorization","then","async","res","status","logout","Promise","reject","userInfo","json","owner","originRepo","split","name","email","login","avatar_url","getPullRequestAuthor","pullRequest","user","DecapCmsBackendAwsCognitoGithubProxy","API"],"ignoreList":[],"sourceRoot":""}